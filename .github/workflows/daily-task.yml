# .github/workflows/daily-task.yml

name: Daily Fetch Task

# 1. 定义触发器
on:
  # 定时触发，每天北京时间上午 9:00 (UTC 时间 01:00) 运行
  schedule:
    - cron: '0 1 * * *'
  
  # 允许手动触发，方便调试
  workflow_dispatch:

# 2. 定义任务
jobs:
  build:
    # 指定运行环境为最新版的 Ubuntu
    runs-on: ubuntu-latest

    steps:
      # 步骤 1: 检出你的仓库代码
      - name: Checkout repository
        uses: actions/checkout@v4

      # 步骤 2: 设置 Node.js 环境
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          # 指定 Node.js 版本
          node-version: '20'
          # --- 移除了 cache: 'npm' 这一行 ---

      # --- 移除了 "Install dependencies" 这整个步骤 ---

      # 步骤 3: 直接执行你的脚本
      - name: Run daily fetch script
        run: node tools/fetch-daily.mjs
